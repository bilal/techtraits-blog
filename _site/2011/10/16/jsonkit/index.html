
<!doctype html>  
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]--> 
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]--> 
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]--> 
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]--> 
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]--> 
<head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
 
  <title>iPhone SDK: Integrating with Json using Jsonkit</title> 
  <meta name="author" content="Name Lastname" />
  <link href='http://fonts.googleapis.com/css?family=Lato:light,regular,bold'
  rel='stylesheet' type='text/css'>
  <link href="/assets/themes/jamesyu/css/
reset.css" media="screen" rel="stylesheet" type="text/css" /> 
  <link href="/assets/themes/jamesyu/css/highlight.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/assets/themes/jamesyu/css/main.css" media="screen" rel="stylesheet" type="text/css" /> 
  <link rel="alternate" type="application/rss+xml" href="/atom.xml" title="RSS feed">
</head> 
 
    <body> 
        <div id="header">
            <div class="inner">
                <ul>
                    <li><a href="http://twitter.com/username">Follow Me</a></li>
                    <li><a href="/about.html">About Me</a></li>
                </ul>
                <h1><a href="/">Name Lastname</a></h1>
                <h2></h2>
            </div>
        </div>
                
        <div id="content">
            <div class="inner">
                
<div class="post">
    <h3><a href="">iPhone SDK: Integrating with Json using Jsonkit</a></h3>
  
    <div class="body">
        <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;p style=&quot;text-align: justify;&quot;&gt;
I have been using the Jackson library in Java for automatic serialization to and from JSON to native objects. Recently I had to implement something similar in the iPhone SDK. I had to google around as the tool chain is not as developed as it is for Java. The best library I have been able to find is &lt;a href=&quot;https://github.com/johnezang/JSONKit&quot; title=&quot;JSONKit&quot; target=&quot;_blank&quot;&gt;JSONKit&lt;/a&gt;. This is a short tutorial detailing how to get it working.

&lt;!--more--&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
First download the &lt;a href=&quot;https://github.com/johnezang/JSONKit/blob/master/JSONKit.h&quot; title=&quot;JSONKit.h&quot;&gt;JSONKit.h&lt;/a&gt; and &lt;a href=&quot;https://github.com/johnezang/JSONKit/blob/master/JSONKit.m&quot; title=&quot;https://github.com/johnezang/JSONKit/blob/master/JSONKit.m&quot;&gt; JSONKit.m&lt;/a&gt; files and add them to your project source. 
&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
Then create an xCode project for your code to go in if you don&apos;t already have one. I am going to use my project from the &lt;a href=&quot;http://www.techtraits.ca/iphone-sdk-hello-world/&quot; title=&quot;http://www.techtraits.ca/iphone-sdk-hello-world/&quot;&gt;HelloWorld&lt;/a&gt; tutorial which you can download here. (&lt;a href=&quot;http://www.techtraits.ca/wp-content/uploads/2011/06/HelloWorld.zip&quot; title=&quot;http://www.techtraits.ca/wp-content/uploads/2011/06/HelloWorld.zip&quot;&gt;HelloWorld Source&lt;/a&gt;)
&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;
Now import the file into your source files wherever you would like to parse to and from JSON source which in may case that is HelloWorldViewController.m

&lt;pre lang=&quot;objC&quot;&gt;
#import JSONKit.h
&lt;/pre&gt;
&lt;/p&gt;

&lt;H3&gt; Creating our Json Strings&lt;/h3&gt;</pre><pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;p style=&quot;text-align: justify;&quot;&gt;

Before we start writing out awesome parsing code lets make some JSON string that we wish to parse. I use a tool called &lt;a href=&quot;http://jsonlint.com/&quot; title=&quot;http://jsonlint.com/&quot;&gt;JSONLint&lt;/a&gt; to create JSON snippets for testing. Here are some test snippets I came up with.
&lt;li&gt;Single Parameter&lt;/li&gt;
&lt;pre lang=&quot;JSON&quot;&gt;
{
    &quot;person&quot;: &quot;Usman&quot;
}
&lt;/pre&gt;

&lt;li&gt;Nested Parameters&lt;/li&gt;
&lt;pre lang=&quot;JSON&quot;&gt;
{
    &quot;person&quot;: {
        &quot;name&quot;: &quot;Usman&quot;,
        &quot;job&quot;: &quot;Software Engineer&quot;
    }
}
&lt;/pre&gt;

&lt;li&gt;Nested Parameters&lt;/li&gt;
&lt;pre lang=&quot;JSON&quot;&gt;
{
    &quot;directory&quot;: [
        {
            &quot;person&quot;: {
                &quot;name&quot;: &quot;Usman&quot;,
                &quot;job&quot;: &quot;Software Engineer&quot;
            }
        },
        {
            &quot;person&quot;: {
                &quot;name&quot;: &quot;Someone else&quot;,
                &quot;job&quot;: &quot;Some other profession&quot;
            }
        }
    ]
}
&lt;/pre&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;
Next we create three methods to return the JSON strings in the form of NSData objects in HelloWorldViewController.m, I have hard coded the strings as shown above with proper escaped characters for line endings and quotation marks.

&lt;pre lang=&quot;objc&quot;&gt;
- (NSData*) getSimpleJSON {
    NSString* jsonString = @&quot;{ \
        \&quot;person\&quot;: \&quot;Usman\&quot; \
    }&quot;;
    return  [jsonString dataUsingEncoding:NSUTF8StringEncoding];
}

- (NSData*) getNestedJSON {
    NSString* jsonString = @&quot;{                      \
        \&quot;person\&quot;: {                               \
            \&quot;name\&quot;: \&quot;Usman\&quot;,                    \
            \&quot;job\&quot;: \&quot;Software Engineer\&quot;   \
        }                                           \
    }&quot;;
   return  [jsonString dataUsingEncoding:NSUTF8StringEncoding];
}

- (NSData*) getJSONList {
    NSString* jsonString = @&quot;                                       \
    {                                                               \
        \&quot;directory\&quot;: [                                            \
                      {                                             \
                          \&quot;person\&quot;: {                            \
                              \&quot;name\&quot;: \&quot;Usman\&quot;,                  \
                              \&quot;job\&quot;: \&quot;Software Engineer\&quot;        \
                          }                                         \
                      },                                            \
                      {                                             \
                          \&quot;person\&quot;: {                            \
                              \&quot;name\&quot;: \&quot;Someone else\&quot;,           \
                              \&quot;job\&quot;: \&quot;Some other profession\&quot;    \
                          }                                         \
                      }                                             \
                ]                                                   \
    }                                                               \
    &quot;;
   return  [jsonString dataUsingEncoding:NSUTF8StringEncoding];
}
&lt;/pre&gt;


&lt;h3&gt;Parsing JSON&lt;/h3&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
Look for the -(void)action:(id)sender method in the code and delete all the code within the method. In it&apos;s place we will first initialize an instance of the JsonDecoder. We then use the &lt;em&gt;objectWithData&lt;/em&gt; of the decoder to parse our simple JSON String into a NSDictionary object. Each property in the json source becomes a key value in the dictionary. The code below shows how we would retrieve the the value of a particular property and output it to console log. 

&lt;pre lang=&quot;objc&quot;&gt;
-(void)action:(id)sender {
    JSONDecoder* decoder = [[JSONDecoder alloc] init];
    NSDictionary *resultsDictionary = [decoder objectWithData:[self getSimpleJSON]];
    NSLog(@&quot;Person: %@&quot;,[resultsDictionary objectForKey:@&quot;person&quot;]);
}
&lt;/pre&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;
Each nested object is parsed as a dictionary of its own, for example when we parse the nested json string we first get a dictionary which contains a key mapping from &lt;em&gt;person&lt;/em&gt; to another dictionary. The second dictionary contains the person&apos;s name and job as key value pairs as shown in the code below. 
&lt;pre lang=&quot;objc&quot;&gt;	
    NSDictionary *nestedDictionary  = [decoder objectWithData:[self getNestedJSON]];
    NSDictionary *personDictionay =  [nestedDictionary objectForKey:@&quot;person&quot;];
    
    NSLog(@&quot;Name: %@&quot;,[personDictionay objectForKey:@&quot;name&quot;]);
    NSLog(@&quot;Job: %@&quot;,[personDictionay objectForKey:@&quot;job&quot;]);
&lt;/pre&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;
JSON Lists map to a an NSArray object where each element of the list is mapped to a NSDictionary object containing the element. For example in our JSONList string the primary dictionary contains a key &lt;em&gt;directory&lt;/em&gt; which maps to a NSArray of dictionaries. Each element in the NSArray maps to a NSDictionary with a key &lt;em&gt;person&lt;/em&gt; which returns a dictionary with the name and job of the person. 
 
&lt;pre lang=&quot;objc&quot;&gt;	
  NSDictionary* listDictionary = [decoder objectWithData:[self getJSONList]];
    NSArray* people =[listDictionary objectForKey:@&quot;directory&quot;];


    for (NSDictionary *person in people) {    
        NSDictionary *personDetails = [person objectForKey:@&quot;person&quot;];
        NSLog(@&quot;Name: %@&quot;,[personDetails objectForKey:@&quot;name&quot;]);
        NSLog(@&quot;Job: %@&quot;,[personDetails objectForKey:@&quot;job&quot;]);
    }
&lt;/pre&gt;

&lt;h3&gt;Running the code&lt;/h3&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
The complete method should now look something like the code shown below. Build &amp; Run your project and click the button on the iPhone emulator when it pops up.
&lt;pre lang=&quot;objc&quot;&gt;	
-(void)action:(id)sender
{
    JSONDecoder* decoder = [[JSONDecoder alloc] init];
    NSDictionary *simpleDictionary = [decoder objectWithData:[self getSimpleJSON]];
    NSLog(@&quot;Person: %@&quot;,[simpleDictionary objectForKey:@&quot;person&quot;]);
    
    NSDictionary *nestedDictionary  = [decoder objectWithData:[self getNestedJSON]];
    NSDictionary *personDictionay =  [nestedDictionary objectForKey:@&quot;person&quot;];
    
    NSLog(@&quot;Name: %@&quot;,[personDictionay objectForKey:@&quot;name&quot;]);
    NSLog(@&quot;Job: %@&quot;,[personDictionay objectForKey:@&quot;job&quot;]);
    
    NSDictionary* listDictionary = [decoder objectWithData:[self getJSONList]];
    NSArray* people =[listDictionary objectForKey:@&quot;directory&quot;];


    for (NSDictionary *person in people) {    
        NSDictionary *personDetails = [person objectForKey:@&quot;person&quot;];
        NSLog(@&quot;Name: %@&quot;,[personDetails objectForKey:@&quot;name&quot;]);
        NSLog(@&quot;Job: %@&quot;,[personDetails objectForKey:@&quot;job&quot;]);
    }
}
&lt;/pre&gt;

Look at your console log and it should show the parsed out data that we printed to the log:
&lt;pre lang=&quot;bash&quot;&gt;
2011-10-16 17:45:12.201 HelloWorld[4005:f803] Person: Usman


2011-10-16 17:45:12.203 HelloWorld[4005:f803] Name: Usman
2011-10-16 17:45:12.203 HelloWorld[4005:f803] Job: Software Engineer


2011-10-16 17:45:12.204 HelloWorld[4005:f803] Name: Usman
2011-10-16 17:45:12.204 HelloWorld[4005:f803] Job: Software Engineer
2011-10-16 17:45:12.204 HelloWorld[4005:f803] Name: Someone else
2011-10-16 17:45:12.205 HelloWorld[4005:f803] Job: Some other profession

&lt;/pre&gt;

&lt;h3&gt;Source Code&lt;/h3&gt;
The updated HelloWorld project source code with changes that we made in this tutorial can be downloaded &lt;a href=&apos;http://www.techtraits.ca/wp-content/uploads/2011/10/HelloWorld_JSONKit.zip&apos;&gt;HelloWorld_JSONKit&lt;/a&gt;.</pre>
    </div>
    
    <div class="meta">    
        <ul>
          Published: 16 Oct 2011<br/>
        </ul>
	<ul class="list-category list-linear">
	  <li class="list-head">category: </li>
			
			


  
    
  


	</ul>
	<ul class="list-tag list-linear">
		<li class="list-head">tags: </li>
			
			


  
    
  



	</ul>
    </div>

    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    var disqus_identifier = '460 http://username.github.com/?p=460';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




</div>


            </div>
        </div>
        
        <div id="footer" class="clearfix">
            <div class="inner">
                <div class="archives">
                    <h3>Archives</h3>
            
                    <table>
                    
                        <tr>
                            <td class="date">10 Mar 2012</td>
                            <td><a href="/2012/03/10/jackson-optimization-using-non-default-for-fun-and-profit">Jackson Optimization, Using Non-Default for fun and profit</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">14 Feb 2012</td>
                            <td><a href="/2012/02/14/really-really-async-aws-sdk">Really Really Async AWS SDK</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">11 Feb 2012</td>
                            <td><a href="/2012/02/11/erlang-list-manipulation-using-comprehensions">Erlang: List Manipulation using comprehensions</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">03 Feb 2012</td>
                            <td><a href="/2012/02/03/java-optimizaiton">Java Optimizaiton, Why is my application so slow?</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">17 Jan 2012</td>
                            <td><a href="/2012/01/17/regular-expressions-in-elipse-find">Regular Expressions in Elipse Find</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">16 Jan 2012</td>
                            <td><a href="/2012/01/16/capturing-java-stack-strace-using-jstack">Capturing Java Stack Strace Using JStack</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">17 Dec 2011</td>
                            <td><a href="/2011/12/17/creating-executable-jars-with-maven">Creating executable jars with Maven</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">04 Dec 2011</td>
                            <td><a href="/2011/12/04/custum-pmd-rule-for-private-injected-fields">Custom PMD Rule for Private Injected fields</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">27 Nov 2011</td>
                            <td><a href="/2011/11/27/using-method-interceptors-with-guice">Using method interceptors with Guice</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">20 Nov 2011</td>
                            <td><a href="/2011/11/20/using-custom-serializers-with-jackson">Using Custom Serializers with Jackson</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">05 Nov 2011</td>
                            <td><a href="/2011/11/05/custom-pmd-rules-using-xpath">Custom PMD Rules using XPath</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">31 Oct 2011</td>
                            <td><a href="/2011/10/31/writting-pretty-code-with-pmd">Writing pretty code with PMD</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">31 Oct 2011</td>
                            <td><a href="/2011/10/31/thanks-i-needed-that">Thanks, I needed that</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">16 Oct 2011</td>
                            <td><a href="/2011/10/16/jsonkit">iPhone SDK: Integrating with Json using Jsonkit</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">10 Oct 2011</td>
                            <td><a href="/2011/10/10/iphonesdk-nsuserdefaults">iPhoneSDK: NSUserDefaults</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">02 Oct 2011</td>
                            <td><a href="/2011/10/02/using-cachedump-to-debug-memcached">Using cachedump to debug memcached</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">02 Oct 2011</td>
                            <td><a href="/2011/10/02/iphone-sdk-tabbars">IPhone SDK: TabBars</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">09 Sep 2011</td>
                            <td><a href="/2011/09/09/compiling-protocol-buffers-from-maven">Compiling Protocol Buffers from Maven</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">05 Sep 2011</td>
                            <td><a href="/2011/09/05/running-nexus-sontaype-over-jetty">Running Nexus Sontaype over Jetty</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">12 Aug 2011</td>
                            <td><a href="/2011/08/12/implementing-jackson-views">Implementing Jackson Views</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">27 Jul 2011</td>
                            <td><a href="/2011/07/27/polymorphic-json-serialization-using-jackson">Polymorphic JSON Serialization using Jackson</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">25 Jun 2011</td>
                            <td><a href="/2011/06/25/five-minute-guide-to-setting-up-a-java-webserver">Setting up a webservice using Guice & Sitebricks</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">12 Jun 2011</td>
                            <td><a href="/2011/06/12/iphone-sdk-hello-world">IPhone SDK Hello World</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">12 Jun 2011</td>
                            <td><a href="/2011/06/12/iphone-sdk-hello-world">IPhone SDK Hello World</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">11 Jun 2011</td>
                            <td><a href="/2011/06/11/records-in-erlang">Records in erlang</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">11 Jun 2011</td>
                            <td><a href="/2011/06/11/records-in-erlang">Records in erlang</a></td>
                        </tr>
                    
                    </table>
                </div>
                <div class="about">
                    <h3><a href="/about.html">About Me</a></h3>
                    
                    <a href="/about.html"><img src="/assets/themes/jamesyu/images/me_small.png" alt="ME" /></a>
                    <div>
                        This is yet a short description of myself. Try to keep it short. <a href="/about.html">Read more</a>
                    </div>
                </div>
            </div>
        </div>
        
    </body> 
</html>

