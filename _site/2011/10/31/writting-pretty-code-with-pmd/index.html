
<!doctype html>  
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]--> 
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]--> 
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]--> 
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]--> 
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]--> 
<head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
 
  <title>Writing pretty code with PMD</title> 
  <meta name="author" content="Bilal Sheikh" />
  <link href='http://fonts.googleapis.com/css?family=Lato:light,regular,bold'
  rel='stylesheet' type='text/css'>
  <link href="/assets/themes/jamesyu/css/
reset.css" media="screen" rel="stylesheet" type="text/css" /> 
  <link href="/assets/themes/jamesyu/css/highlight.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/assets/themes/jamesyu/css/main.css" media="screen" rel="stylesheet" type="text/css" /> 
  <link rel="alternate" type="application/rss+xml" href="/atom.xml" title="RSS feed">
</head> 
 
    <body> 
        <div id="header">
            <div class="inner">
                <ul>
                    <li><a href="http://twitter.com/mbsheikh">Follow Me</a></li>
                    <li><a href="/about.html">About Me</a></li>
                </ul>
                <h1><a href="/">Tech Traits</a></h1>
                <h2></h2>
            </div>
        </div>
                
        <div id="content">
            <div class="inner">
                
<div class="post">
    <h3><a href="">Writing pretty code with PMD</a></h3>
  
    <div class="body">
        <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;p style=&quot;text-align: justify;&quot;&gt;
I recently found myself in the role of lead developer in my team and had to manage the work of several other junior developers. This is has been an interesting and rewarding experience and has taught me a lot about my self as a person and as a developer. I will leave the personal epiphanies for another time but as a developer I found that I have a lot of pet peeves about what code looks like and I want my juniors to cater to them. For example else must be written ...} else {... In addition some random preferences for code layout standards there are some genuine bugs that junior devs (who am I kidding, I am as bad as they are) leave in when writing code which are easily detectable and using a cursory review. That is were &lt;a href=&quot;http://pmd.sourceforge.net/&quot; title=&quot;PMD&quot;&gt;PMD&lt;/a&gt; comes in, with PMD you can force every one to following coding conventions otherwise fail the build. PMD comes with a nifty set of predefined rules and you can also easily add your own using &lt;a href=&quot;http://www.w3schools.com/xpath/&quot; title=&quot;xPath&quot; target=&quot;_blank&quot;&gt;xPath&lt;/a&gt;. 
&lt;!--more--&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
Don&apos;t ask me what PMD stands for, I have tried in vain to find that out using extensive googleing. &lt;a href=&quot;http://pmd.sourceforge.net/meaning.html&quot; title=&quot;What does PMD Mean&quot; target=&quot;_blank&quot;&gt;Here&lt;/a&gt; is a list of possible answers. What it does is allow you to add a build phase to your project which checks your code against a predefined set of rules and generates a report on violations. Many tools (&lt;a href=&quot;http://jenkins-ci.org/&quot; title=&quot;Jenkins&quot; target=&quot;_blank&quot;&gt;Jenkins&lt;/a&gt;, &lt;a href=&quot;http://www.sonarsource.org/&quot; title=&quot;Sonar&quot; target=&quot;_blank&quot;&gt;Sonar&lt;/a&gt; etc) will integrate directly with PMD and provide UI to browse code easily. I will go into the tools in subsequent articles but for now a quick tutorial on how to integrate PMD with your build. 

As a starting point I will use code I wrote to go along with an earlier article &lt;a href=&quot;http://www.techtraits.ca/five-minute-guide-to-setting-up-a-java-webserver/&quot; title=&quot;Setting up a webservice using Guice &amp; Sitebricks&quot; target=&quot;_blank&quot;&gt;Setting up a webservice using Guice &amp; Sitebricks&lt;/a&gt;. The code is available &lt;a href=&quot;http://www.techtraits.ca/wp-content/uploads/2011/06/helloworld.zip&quot; title=&quot;Hello World&quot;&gt;here&lt;/a&gt;. This is Java project build using maven, but PMD integration is available with other build systems and languages. Download and extract the code and compile using &lt;a href=&quot;http://maven.apache.org/ref/3.0/&quot; title=&quot;Maven 3&quot; target=&quot;_blank&quot;&gt;Maven&lt;/a&gt; just to ensure everything is hunky dory.  
&lt;pre lang=&quot;bash&quot;&gt;
&gt; cd ${WHEREEVER_YOU_EXTRACTED_IT}/helloworld
&gt; mvn clean install
&lt;/pre&gt;

Hopefully you see something like:
&lt;pre lang=&quot;bash&quot;&gt;
[INFO] Installing /Users/usman/Downloads/helloworld/pom.xml to /Users/usman/.m2/repository/com/flybynight/helloworld/helloworld/1.0-SNAPSHOT/helloworld-1.0-SNAPSHOT.pom
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 4.372s
[INFO] Finished at: Mon Oct 31 20:34:07 EDT 2011
[INFO] Final Memory: 11M/81M
[INFO] ------------------------------------------------------------------------
&lt;/pre&gt;


&lt;h3&gt;Maven PMD plugin&lt;/h3&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
To integrate PMD with your maven build open the pom.xml file in the project root and look for the &lt;plugins&gt; tag. We will add the pmd plugin reference here. 

&lt;pre lang=&quot;xml&quot;&gt;
&lt;plugin&gt;
	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
	&lt;artifactId&gt;maven-pmd-plugin&lt;/artifactId&gt;
	&lt;version&gt;2.5&lt;/version&gt;
	&lt;configuration&gt;
		&lt;targetJdk&gt;1.6&lt;/targetJdk&gt;
		&lt;linkXref&gt;false&lt;/linkXref&gt;
		&lt;failOnViolation&gt;true&lt;/failOnViolation&gt;
		&lt;failurePriority&gt;1&lt;/failurePriority&gt;
		&lt;rulesets&gt;
			&lt;ruleset&gt;${pom.basedir}/pmd-rulesets.xml&lt;/ruleset&gt;
		&lt;/rulesets&gt;
	&lt;/configuration&gt;
	&lt;executions&gt;
		&lt;execution&gt;
			&lt;goals&gt;
				&lt;goal&gt;check&lt;/goal&gt;
			&lt;/goals&gt;
		&lt;/execution&gt;
	&lt;/executions&gt;
&lt;/plugin&gt; 
&lt;/pre&gt;

&lt;h3&gt;Configuration&lt;/h3&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
Most of the parameters above are fairly self explanatory except linkXref which specifies whether our PMD report should have links to the cross referenced source code. The failOnViolation and  failurePriority are used to control when we fail the build. All PMD violations have a priority (as we will see later) ranging from 1-5 with 1 being the worst violations and 5 being the least heinous. In our configuration we are specifying that any violation should break the build (Using the &lt;em&gt;failOnViolation&lt;/em&gt; tag) and that all warnings priority 1 (or higher if we had specified a lower number) should be considered violations (Using the &lt;em&gt;failurePriority&lt;/em&gt; tag). All other priorities will result in a warning but will still allow the build to succeed. 

&lt;h3&gt;Rule sets&lt;/h3&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
In the configuration above we are specifying a rule sets file which contains all the rules which our code will be checked against. You can see a complete set of common rule sets here: &lt;a href=&quot;http://pmd.sourceforge.net/rules/index.html&quot; title=&quot;Rule Sets&quot; target=&quot;_blank&quot;&gt;Rule Sets&lt;/a&gt; and the rule set definition I have used here &lt;a href=&apos;http://www.techtraits.ca/wp-content/uploads/2011/11/pmd-rulesets.xml_.txt&apos;&gt;pmd-rulesets.xml&lt;/a&gt;. In addition the snippet below shows the format of the rule set file. Each &lt;em&gt;rule&lt;/em&gt; element in the links to one of the predefined rules and assigns a priority to it. 

&lt;pre lang=&quot;xml&quot;&gt;
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;ruleset name=&quot;PMD-Rules&quot;&gt;
	&lt;description&gt;
		Rule sets go here
	&lt;/description&gt;
	&lt;rule ref=&quot;rulesets/basic.xml/BooleanInstantiation&quot;&gt;
		&lt;priority&gt;5&lt;/priority&gt;
	&lt;/rule&gt; 
	&lt;rule ref=&quot;rulesets/basic.xml/CollapsibleIfStatements&quot;&gt;
		&lt;priority&gt;5&lt;/priority&gt;
	&lt;/rule&gt; 
&lt;/ruleset&gt;
&lt;/pre&gt;

&lt;h3&gt;PMD in action&lt;/h3&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
Download this rule set file (&lt;a href=&apos;http://www.techtraits.ca/wp-content/uploads/2011/11/pmd-rulesets.xml_.txt&apos;&gt;pmd-rulesets.xml&lt;/a&gt;) and add it to your project base directory. (Note you will have to rename and remove the .txt) Now recompile the project using mvn clean install and you should get the following log output. 
&lt;pre lang=&quot;bash&quot;&gt;
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 4.368s
[INFO] Finished at: Mon Oct 31 21:14:53 EDT 2011
[INFO] Final Memory: 15M/81M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-pmd-plugin:2.5:check (default) on project helloworld: You have 1 PMD violation. For more details see:/XXXXXXXXXX/helloworld/target/pmd.xml -&gt; [Help 1]
&lt;/pre&gt;

Open up the pmd.xml file to see the PMD report; Luckily we only have one violation where we forgot to remove an unused import. As you can see the report reports the file and the line number where the violation is found. 

&lt;pre lang=&quot;xml&quot;&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;pmd version=&quot;4.2.5&quot; timestamp=&quot;2011-10-31T21:14:52.771&quot;&gt;
&lt;file name=&quot;/Users/usman/Downloads/helloworld/src/main/java/com/flybynight/helloworld/GuiceCreator.java&quot;&gt;
&lt;violation beginline=&quot;7&quot; endline=&quot;7&quot; begincolumn=&quot;1&quot; endcolumn=&quot;47&quot; rule=&quot;UnusedImports&quot; ruleset=&quot;Import Statement Rules&quot; package=&quot;com.flybynight.helloworld&quot; externalInfoUrl=&quot;http://pmd.sourceforge.net/rules/imports.html#UnusedImports&quot; priority=&quot;1&quot;&gt;
Avoid unused imports such as &apos;com.google.inject.servlet.ServletModule&apos;
&lt;/violation&gt;
&lt;/file&gt;
&lt;/pmd&gt;
&lt;/pre&gt;

&lt;h3&gt;Source Code&lt;/h3&gt;
	&lt;li&gt;&lt;a href=&quot;http://www.techtraits.ca/wp-content/uploads/2011/06/helloworld.zip&quot; title=&quot;Initial Code&quot; target=&quot;_blank&quot;&gt;Initial Code&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&apos;http://www.techtraits.ca/wp-content/uploads/2011/11/helloworld.zip&apos;&gt;PMD Integrated Project&lt;/a&gt;&lt;/li&gt;


&lt;h3&gt;External Links&lt;/h3&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;http://pmd.sourceforge.net/&quot; title=&quot;PMD&quot;&gt;http://pmd.sourceforge.net/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://www.w3schools.com/xpath/&quot; title=&quot;XPath&quot;&gt;http://www.w3schools.com/xpath/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://jenkins-ci.org/&quot; title=&quot;Jenkins&quot; target=&quot;_blank&quot;&gt;http://jenkins-ci.org/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://www.sonarsource.org/&quot; title=&quot;Sonar&quot; target=&quot;_blank&quot;&gt;http://www.sonarsource.org/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://pmd.sourceforge.net/rules/index.htm&quot; title=&quot;Rule Sets&quot; target=&quot;_blank&quot;&gt;http://pmd.sourceforge.net/rules/index.htm&lt;/a&gt;&lt;/li&gt;</pre>
    </div>
    
    <div class="meta">    
        <ul>
          Published: 31 Oct 2011<br/>
        </ul>
	<ul class="list-category list-linear">
	  <li class="list-head">category: </li>
			
			


  
    
  


	</ul>
	<ul class="list-tag list-linear">
		<li class="list-head">tags: </li>
			
			


  
    
  



	</ul>
    </div>

    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    var disqus_identifier = '541 http://username.github.com/?p=541';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




</div>


            </div>
        </div>
        
        <div id="footer" class="clearfix">
            <div class="inner">
                <div class="archives">
                    <h3>Archives</h3>
            
                    <table>
                    
                        <tr>
                            <td class="date">10 Mar 2012</td>
                            <td><a href="/2012/03/10/jackson-optimization-using-non-default-for-fun-and-profit">Jackson Optimization, Using Non-Default for fun and profit</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">14 Feb 2012</td>
                            <td><a href="/2012/02/14/really-really-async-aws-sdk">Really Really Async AWS SDK</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">11 Feb 2012</td>
                            <td><a href="/2012/02/11/erlang-list-manipulation-using-comprehensions">Erlang: List Manipulation using comprehensions</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">03 Feb 2012</td>
                            <td><a href="/2012/02/03/java-optimizaiton">Java Optimizaiton, Why is my application so slow?</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">17 Jan 2012</td>
                            <td><a href="/2012/01/17/regular-expressions-in-elipse-find">Regular Expressions in Elipse Find</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">16 Jan 2012</td>
                            <td><a href="/2012/01/16/capturing-java-stack-strace-using-jstack">Capturing Java Stack Strace Using JStack</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">17 Dec 2011</td>
                            <td><a href="/2011/12/17/creating-executable-jars-with-maven">Creating executable jars with Maven</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">04 Dec 2011</td>
                            <td><a href="/2011/12/04/custum-pmd-rule-for-private-injected-fields">Custom PMD Rule for Private Injected fields</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">27 Nov 2011</td>
                            <td><a href="/2011/11/27/using-method-interceptors-with-guice">Using method interceptors with Guice</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">20 Nov 2011</td>
                            <td><a href="/2011/11/20/using-custom-serializers-with-jackson">Using Custom Serializers with Jackson</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">05 Nov 2011</td>
                            <td><a href="/2011/11/05/custom-pmd-rules-using-xpath">Custom PMD Rules using XPath</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">31 Oct 2011</td>
                            <td><a href="/2011/10/31/writting-pretty-code-with-pmd">Writing pretty code with PMD</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">31 Oct 2011</td>
                            <td><a href="/2011/10/31/thanks-i-needed-that">Thanks, I needed that</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">16 Oct 2011</td>
                            <td><a href="/2011/10/16/jsonkit">iPhone SDK: Integrating with Json using Jsonkit</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">10 Oct 2011</td>
                            <td><a href="/2011/10/10/iphonesdk-nsuserdefaults">iPhoneSDK: NSUserDefaults</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">02 Oct 2011</td>
                            <td><a href="/2011/10/02/using-cachedump-to-debug-memcached">Using cachedump to debug memcached</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">02 Oct 2011</td>
                            <td><a href="/2011/10/02/iphone-sdk-tabbars">IPhone SDK: TabBars</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">09 Sep 2011</td>
                            <td><a href="/2011/09/09/compiling-protocol-buffers-from-maven">Compiling Protocol Buffers from Maven</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">05 Sep 2011</td>
                            <td><a href="/2011/09/05/running-nexus-sontaype-over-jetty">Running Nexus Sontaype over Jetty</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">12 Aug 2011</td>
                            <td><a href="/2011/08/12/implementing-jackson-views">Implementing Jackson Views</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">27 Jul 2011</td>
                            <td><a href="/2011/07/27/polymorphic-json-serialization-using-jackson">Polymorphic JSON Serialization using Jackson</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">25 Jun 2011</td>
                            <td><a href="/2011/06/25/five-minute-guide-to-setting-up-a-java-webserver">Setting up a webservice using Guice & Sitebricks</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">12 Jun 2011</td>
                            <td><a href="/2011/06/12/iphone-sdk-hello-world">IPhone SDK Hello World</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">12 Jun 2011</td>
                            <td><a href="/2011/06/12/iphone-sdk-hello-world">IPhone SDK Hello World</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">11 Jun 2011</td>
                            <td><a href="/2011/06/11/records-in-erlang">Records in erlang</a></td>
                        </tr>
                    
                        <tr>
                            <td class="date">11 Jun 2011</td>
                            <td><a href="/2011/06/11/records-in-erlang">Records in erlang</a></td>
                        </tr>
                    
                    </table>
                </div>
                <div class="about">
                    <h3><a href="/about.html">About Me</a></h3>
                    
                    <a href="/about.html"><img src="/assets/themes/jamesyu/images/me_small.png" alt="ME" /></a>
                    <div>
                        This is yet a short description of myself. Try to keep it short. <a href="/about.html">Read more</a>
                    </div>
                </div>
            </div>
        </div>
        
    </body> 
</html>

